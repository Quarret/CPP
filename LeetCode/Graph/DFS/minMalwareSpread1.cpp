#include <bits/stdc++.h>
using ll = long long;
using namespace std;

//zheng xiang O(m * n ^ 2)
int minMalwareSpread(vector<vector<int>>& graph, vector<int>& initial) {
    int n = graph.size();
    vector<int> infected(n);
    for (int u : initial) infected[u] = 1;
    
    vector<int> vis(n);
    int ok = 0, cnt = 0;
    auto dfs = [&](this auto&& dfs, int u, int d) -> void {
        vis[u] = 1;
        cnt++;
        if (infected[u]) ok = 1;

        for (int v = 0; v < n; v++) {
            if (v == d) continue;
            if (graph[u][v] && !vis[v]) dfs(v, d);
        }
    };

    int minn = 1e9, ans = 1e9;
    for (int u : initial) {
        int s = 0;
        vis.assign(vis.size(), 0);
        for (int i = 0; i < n; i++) {
            ok = 0, cnt = 0;
            if (i == u) continue;
            if (!vis[i]) dfs(i, u);
            if (ok) s += cnt;
        }

        if (s == minn) ans = min(ans, u);
        else if (s < minn) {
            minn = s;
            ans = u;
        }
    }

    return ans;
}

//ni xiang O(n ^ 2) not completed
int minMalwareSpread(vector<vector<int>>& graph, vector<int>& initial) {
    int n = graph.size(), mn = 1e9;
    vector<int> infected(n);
    for (int x : initial) {
        infected[x] = 1;
        mn = min(mn, x);
    }
    
    vector<int> vis(n);
    int cnt = 0, cnt1 = 0, idx = 1e9;
    auto dfs = [&](this auto&& dfs, int u) -> void {
        vis[u] = 1;
        cnt++;

        for (int v = 0; v < n; v++) {
            if (graph[u][v]) {
                if (infected[v]) {
                    if (idx == 1e9) idx = v;
                    cnt1++;
                } else if (!vis[v]) dfs(v);
            }
        }
    };

    unordered_map<int, int> mp;
    for (int u = 0; u < n; u++) {
        cnt = 0, cnt1 = 0, idx = 1e9;
        if (!infected[u] && !vis[u]) dfs(u);
        if (cnt1 == 1) mp[idx] += cnt;
    }

    if (!mp.size()) return mn;

    int minn = 1e9, ans = 1e9;
    for (auto [num, c] : mp) {
        if (c == minn) ans = min(ans, num);
        else if (c < minn) ans = num;
        minn = min(minn, c);
    }

    return ans;
}
int main() {
    ios::sync_with_stdio(false);
    cin.tie(NULL);

}
